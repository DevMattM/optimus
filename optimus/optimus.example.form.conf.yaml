# project specific processing

project: "hcv_target"

# redcap form stuff

event_data: &event_data redcap_event_name

derived_types:
  status: &status status

cbc: &cbc
  form_name: cbc_imported
  events: 200
  csv_fields: 
    record_id: &record_id dm_subjid
    wbc_vel: &wbc_val wbc_im_lborres # white blood cell
    wbc_unit: &wbc_unit wbc_im_lborresu
    neutrophils_percent: &neut_percent neut_im_lborres
    neutrophils_percent_unit: &neut_percent_unit neut_im_lborresu
    absolute_neutrophils: &abs_neut anc_im_lborres
    absolute_neutrophils_unit: &abs_neut_unit anc_im_lborresu
    lymphocytes_total_cells: &lymphocytes_total_cells lymce_im_lborres
    lymphocytes_total_cells_units: &lymphocytes_total_cells_units lymce_im_lborresu
    lymphocytes: &lymphocytes lym_im_lborres
    lymphocytes_units: &lymphocytes_units lym_im_lborresu
    platelets: &platelets plat_im_lborres
    platelets_units: &platelets_units plat_im_lborresu
    hemoglobin: &hemoglobin hemo_im_lborres
    hemoglobin_units: &hemoglobin_units hemo_im_lborresu
  derived_fields:
    wbc_completed: &wbc_complete
      field: wbc_im_lbstat
      type: *status
      uses: [*wbc_val, *wbc_unit]
    neutrophils_completed: &neut_complete
      field: neut_im_lbstat
      type: *status
      uses: [*neut_percent, *neut_percent_unit]
    absolute_neutrophils_completed: &abs_neut_complete
      field: anc_im_lbstat
      type: *status
      uses: [*abs_neut, *abs_neut_unit]
    lymphocytes_total_cells_completed: &lymce_complete
      field: lymce_im_lbstat
      type: *status
      uses: [*lymphocytes_total_cells, *lymphocytes_total_cells_units]
    lymphocytes_completed: &lym_complete
      field: lym_im_lbstat
      type: *status
      uses: [*lymphocytes, *lymphocytes_units]
    platelets_completed: &platelets_complete
      field: plat_im_lbstat
      type: *status
      uses: [*platelets, *platelets_units]
    hemoglobin_completed: &hemoglobin_complete
      field: hemo_im_lbstat
      type: *status
      uses: [*hemoglobin, *hemoglobin_units]
    done_date: &cbc_done_date
      field: cbc_im_lbdtc
      uses: *event_data
    
chemistry: &chemistry
  form_name: chem_imported
  events: 200
  csv_fields: 
    sodium_value: &sodium_value sodium_im_borres
    sodium_unit: &sodium_unit sodium_im_borresu
    albumin_value: &albumin_value alb_im_borres
    albumin_unit: &albumin_unit alb_im_borresu
  derived_fields:
    done_date: &chem_done_date chem_im_lbdtc
    sodium_completed: &sodium_completed sodium_im_lbstat
    albumin_completed: &albumin_completed alb_im_lbstat

inr: &inr
  form_name: inr_imported
  events: 120
  csv_fields:
  derived_fields:
    done_date: &inr_done_date inr_im_lbdtc

hcvrna: &hcvrna
  form_name: hcv_rna_imported
  events: 60
  csv_fields:
  derived_fields:
    done_date: &rna_done_date hcv_im_lbdtc

forms:
  - *cbc
  - *chemistry
  - *inr
  - *hcvrna

# csv stuff
delimiter: ','
quotechar: '"'
headers:
  subject_header: &subject STUDY_ID
  value_header: &value_header ORD_VALUE
  unit_header: &unit_header REFERENCE_UNIT
  event_header: &event_header RESULT_DATE
  test_ident_header: &test_name NAME

key_header: *test_name
test: &field_delete fjsdkl
test: &format_date fjsdkl
rows:
  - row_key: WBC URINE
    outputs:
      - datum: *value_header
        field: *wbc_val
        date: *event_header
        subj: *subject
      - datum: *unit_header
        field: *wbc_unit
        date: *event_header
        subj: *subject

  - row_key: NEUTROPHILS
    outputs:
      - datum: *value_header
        field: *neut_percent
        date: *event_header
        subj: *subject
      - datum: *unit_header
        field: *neut_percent_unit
        date: *event_header
        subj: *subject

  # - row_key: SODIUM
  #   headers:
  #     - header: *value_header
  #       field: *sodium_value
  #     - header: *unit_header
  #       field: *sodium_unit
  #     - header: *event_header
  #       field: *chem_done_date

  # - row_key: ALBUMIN
  #   headers:
  #     - header: *value_header
  #       field: *albumin_value
  #     - header: *unit_header
  #       field: *albumin_unit
  #     - header: *event_header
  #       field: *chem_done_date

  # - row_key: ALT (SGOT)
  #   headers:
  #     - header: *value_header
  #       field: ast_im_lborres
  #     - header: *unit_header
  #       field: ast_im_lborresu
  #     - field: ast_im_lbstat
  #       value: *field_delete
  #     - field: chem_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: ALT (SGPT)
  #   headers:
  #     - header: *value_header
  #       field: alt_im_lborres
  #     - header: *unit_header
  #       field: alt_im_lborresu
  #     - field: alt_im_lbstat
  #       value: *field_delete
  #     - field: chem_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: BILIRUBIN DIRECT
  #   headers:
  #     - header: *value_header
  #       field: dbil_im_lborres
  #     - header: *unit_header
  #       field: dbil_im_lborresu
  #     - field: dbil_im_lbstat
  #       value: *field_delete
  #     - field: chem_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: BILIRUBIN TOTAL
  #   headers:
  #     - header: *value_header
  #       field: tbil_im_lborres
  #     - header: *unit_header
  #       field: tbil_im_lborresu
  #     - field: tbil_im_lbstat
  #       value: *field_delete
  #     - field: chem_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: CREATININE
  #   headers:
  #     - header: *value_header
  #       field: creat_im_lborres
  #     - header: *unit_header
  #       field: creat_im_lborresu
  #     - field: creat_im_lbstat
  #       value: *field_delete
  #     - field: chem_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: INR
  #   headers:
  #     - header: *value_header
  #       field: inr_im_lborres
  #     - field: inr_im_lbstat
  #       value: *field_delete
  #     - field: inr_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: GLUCOSE
  #   headers:
  #     - header: *value_header
  #       field: gluc_im_lborres
  #     - header: *unit_header
  #       field: gluc_im_lborresu
  #     - field: gluc_im_lbstat
  #       value: *field_delete
  #     - field: chem_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: HCV RNA, QUANTITATIVE REAL TIME PCR
  #   headers:
  #     - header: *value_header
  #       field: hcv_im_lborres
  #     - header: *unit_header
  #       field: hcv_im_lborresu
  #     - header: *event_header
  #       field: hcv_im_lbdtc
  #       transform: *format_date
  #     - value: "Y"
  #       field: hcv_im_supplb_hcvquant

  # - row_key: HEMOGLOBIN
  #   headers:
  #     - header: *value_header
  #       field: hemo_im_lborres
  #     - header: *unit_header
  #       field: hemo_im_lborresu
  #     - field: hemo_im_lbstat
  #       value: *field_delete
  #     - field: cbc_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: LYMPHOCYTES
  #   headers:
  #     - header: *value_header
  #       field: lymce_im_lborres
  #     - header: *unit_header
  #       field: lymce_im_lborresu
  #     - field: lymce_im_lbstat
  #       value: *field_delete
  #     - field: cbc_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: LYMPHOCYTES ABSOLUTE COUNT
  #   headers:
  #     - header: *value_header
  #       field: lym_im_lborres
  #     - header: *unit_header
  #       field: lym_im_lborresu
  #     - field: lym_im_lbstat
  #       value: *field_delete
  #     - field: cbc_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: NEUTROPHILS ABSOLUTE COUNT
  #   headers:
  #     - header: *value_header
  #       field: anc_im_lborres
  #     - header: *unit_header
  #       field: anc_im_lborresu
  #     - field: anc_im_lbstat
  #       value: *field_delete
  #     - field: cbc_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: PLATELET COUNT
  #   headers:
  #     - header: *value_header
  #       field: plat_im_lborres
  #     - header: *unit_header
  #       field: plat_im_lborresu
  #     - field: plat_im_lbstat
  #       value: *field_delete
  #     - field: cbc_im_lbdtc
  #       header: *event_header
  #       transform: *format_date

  # - row_key: POTASSIUM
  #   headers:
  #     - header: *value_header
  #       field: k_im_lborres
  #     - header: *unit_header
  #       field: k_im_lborresu
  #     - field: k_im_lbstat
  #       value: *field_delete
  #     - field: chem_im_lbdtc
  #       header: *event_header
  #       transform: *format_date


